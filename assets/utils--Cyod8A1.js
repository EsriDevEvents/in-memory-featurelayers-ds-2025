import{lO as p,lP as d,lQ as f,lR as y,de as m,d$ as b}from"./index-Dv-JqQDv.js";function w(e){if(!e.colorStops)return[];const a=[...e.colorStops].filter(s=>{var o;return((o=s.color)==null?void 0:o.a)>0});let r=a.length-1;if(a&&a[0]){const s=a[r];s&&s.ratio!==1&&(a.push(new p({ratio:1,color:s.color})),r++)}return a.map((s,o)=>{var n,l;let t="";return o===0?t=((n=e.legendOptions)==null?void 0:n.minLabel)||"low":o===r&&(t=((l=e.legendOptions)==null?void 0:l.maxLabel)||"high"),{color:s.color,label:t,ratio:s.ratio}}).reverse()}const h=m("short-date");async function i(e,a,r){b(e,a,()=>[]).push(...r)}async function g(e){var r,s;const a=new Map;if(!e)return a;if("visualVariables"in e&&e.visualVariables){const o=e.visualVariables.filter(t=>t.type==="color");for(const t of o){const n=(await d(t)??[]).map(l=>l.color);await i(a,t.field||t.valueExpression,n)}}if(e.type==="heatmap"){const o=w(e).map(t=>t.color);await i(a,e.field||e.valueExpression,o)}else if(e.type==="pie-chart"){for(const o of e.attributes)await i(a,o.field||o.valueExpression,[o.color]);await i(a,"default",[(r=e==null?void 0:e.othersCategory)==null?void 0:r.color,f(e.backgroundFillSymbol,null)])}else if(e.type==="dot-density"){for(const o of e.attributes)await i(a,o.field||o.valueExpression,[o.color]);await i(a,"default",[e.backgroundColor])}else if(e.type==="unique-value")if(((s=e.authoringInfo)==null?void 0:s.type)==="predominance")for(const o of e.uniqueValueInfos??[])await i(a,o.value.toString(),[f(o.symbol,null)]);else{const o=(e.uniqueValueInfos??[]).map(c=>f(c.symbol,null)),{field:t,field2:n,field3:l,valueExpression:u}=e;(t||u)&&await i(a,t||u,o),n&&await i(a,n,o),l&&await i(a,l,o)}else if(e.type==="class-breaks"){const o=e.classBreakInfos.map(l=>f(l.symbol,null)),{field:t,valueExpression:n}=e;await i(a,t??n,o)}else e.type==="simple"&&await i(a,"default",[f(e.symbol,null)]);return"defaultSymbol"in e&&e.defaultSymbol&&await i(a,"default",[f(e.defaultSymbol,null)]),a.forEach((o,t)=>{const n=y(o.filter(Boolean),(l,u)=>JSON.stringify(l)===JSON.stringify(u));a.set(t,n)}),a}export{w as r,h as v,g as x};
