import{o as l,gH as h,dZ as g,ar as w,eV as f,eU as d,hX as n,j as u,P as V}from"./index-Dv-JqQDv.js";import{f as b}from"./LayerView2D-Ulqog2NM.js";import{t as S}from"./GraphicContainer-Cy_BIt0k.js";import{V as _}from"./GraphicsView2D-C4K17d-1.js";import{y as T}from"./LayerView-6INZgiuX.js";import"./Container-BCZInv5n.js";import"./DefaultUI-BWAdHYa0.js";import"./jsxFactory-C3RLkrq9.js";import"./UpdatingHandles-C0Kh7aEt.js";import"./InputManager-BwD1PEf3.js";import"./signal-0tlktF45.js";import"./Map-DV4_DU8O.js";import"./Ground-DpNOewuO.js";import"./CollectionFlattener-73Uag1LF.js";import"./editableLayers-V9yr_aA-.js";import"./catalogUtils-CiWgGrdS.js";import"./TablesMixin-BFT6ikAR.js";import"./GraphicsCollection-DlcRCtU0.js";import"./ReactiveMap-DxvIcNmk.js";import"./selectionUtils-DYi6daQO.js";import"./IViewEvents-Bci6PjlS.js";import"./interfaces-D6pIddIh.js";import"./screenUtils-DKZWDFXK.js";import"./a11yUtils-DW8v-NB5.js";import"./heightModelInfoUtils-DQiO1_HQ.js";import"./ViewingMode-Dodu7ZZk.js";import"./capabilities-C84AMSCg.js";import"./themeUtils-C3zvZbsE.js";import"./globalCss-CZa70j6i.js";import"./accessibleHandler-CEs_6QlQ.js";import"./Compass-DBSyeZOs.js";import"./utils-DsJqvptN.js";import"./GoTo-BCG1WN4R.js";import"./NavigationToggle-CRz1xlJz.js";import"./Zoom-C6srvgaZ.js";import"./EffectView-D358IIvW.js";import"./DisplayObject-NwP1D55U.js";import"./highlightReasons-Bl95o-z6.js";import"./Tile-BD3hIcqg.js";import"./quickselect-D0_cvEX6.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./TileKey-DixmkgbB.js";import"./definitions-ByNBSgP9.js";import"./enums-BlUEVwJR.js";import"./Texture-BsiXXqc8.js";import"./ClipRect-C_x5PYDD.js";import"./layerViewUtils-D2JqIDZ8.js";import"./AGraphicContainer-BCFkzrhS.js";import"./TechniqueInstance-C2g9Xtfa.js";import"./UpdateTracking2D-DLChT46s.js";import"./BindType-BmZEZMMh.js";import"./Util-CQaYQWOS.js";import"./vec2f64-Diu2Kaa8.js";import"./Program-By3cM00b.js";import"./BufferObject-Dhco7AlX.js";import"./LabelMetric-CSrxjJk_.js";import"./enums-BRXbslMp.js";import"./VertexElementDescriptor-BOD-G50G.js";import"./BoundingBox-BhuXqU4L.js";import"./vec2f32-BbH2jxlN.js";import"./TileContainer-DO1c6A5U.js";import"./WGLContainer-m5Dqdi-d.js";import"./VertexArrayObject-Czm05pt7.js";import"./WGLBrushVTLSymbol-Hhd0CFGx.js";import"./vec4f32-CjrfB-0a.js";import"./StyleDefinition-BK3ROBTO.js";import"./config-MDUrh2eL.js";import"./ShaderCompiler-G2XYGDs6.js";import"./ProgramTemplate-DUy4DuxJ.js";import"./DefaultVertexAttributeLayouts-BaFfZuup.js";import"./mat3-B7LiNcRs.js";import"./mat2df32-orApM5a3.js";import"./mat2d-C6u6dH6d.js";import"./vec3f32-Cw9Q6TO_.js";import"./earcut-BqgeR2O3.js";import"./vec2-DGogPjh1.js";import"./MapView-BeVtHZG4.js";import"./Viewpoint-kowK2Ox4.js";import"./Cyclical-L5YKfO29.js";import"./TileInfo-Dsgw3bLM.js";import"./TileKey-DZd6gJy7.js";import"./viewpointUtils-CBa44EU3.js";import"./mat2df64-CBKYtunK.js";import"./unitBezier-BX6NeAEr.js";import"./TileStrategy-Bm9AEGL5.js";import"./QueueProcessor-DHxW4yaI.js";import"./utils-CXgSw6Sd.js";import"./ColorBackground-DO2jUIHL.js";import"./FeatureCommandQueue-D3L0Wlvg.js";import"./CIMSymbolHelper-DBCkPMeB.js";import"./BidiEngine-BwB1Df7c.js";import"./fontUtils-CnE29zYd.js";import"./GeometryUtils-CGcKgdcH.js";import"./Rect-CUzevAry.js";import"./heatmapTextureUtils-Y8Y_7g3k.js";import"./constants-D5zmR9t2.js";import"./AttributeStore-Ci4QkEXR.js";import"./labelFormatUtils-Dqk4IbyQ.js";import"./TimeOnly-DM31kLsz.js";import"./centroid-DdLmOD72.js";import"./timeSupport-DgYx0Uxy.js";import"./json-Wa8cmqdu.js";import"./normalizeUtilsSync-B3yip2wp.js";let y=class extends b(T){constructor(){super(...arguments),this._graphicsViewMap={},this._popupTemplates=new Map,this.graphicsViews=[]}async hitTest(t,o){if(!this.graphicsViews.length)return null;const p=this.layer;return this.graphicsViews.reverse().flatMap(r=>{const i=this._popupTemplates.get(r),m=r.hitTest(t);for(const e of m)e.layer=p,e.sourceLayer=p,e.popupTemplate=i;return m}).map(r=>({type:"graphic",graphic:r,layer:p,mapPoint:t}))}update(t){if(this.graphicsViews)for(const o of this.graphicsViews)o.processUpdate(t)}attach(){this.addAttachHandles([l(()=>{var t;return(t=this.layer)==null?void 0:t.featureCollections},t=>{this._clear();for(const{popupInfo:o,featureSet:p,layerDefinition:r}of t){const i=g.fromJSON(p),m=new w(i.features),e=r.drawingInfo,c=o?f.fromJSON(o):null,s=d(e.renderer),a=new _({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:m,renderer:s,container:new S(this.view.featuresTilingScheme)});this._graphicsViewMap[i.geometryType]=a,this._popupTemplates.set(a,c),i.geometryType!=="polygon"||this.layer.polygonSymbol?i.geometryType!=="polyline"||this.layer.lineSymbol?i.geometryType!=="point"||this.layer.pointSymbol||(this.layer.pointSymbol=s.symbol):this.layer.lineSymbol=s.symbol:this.layer.polygonSymbol=s.symbol,this.graphicsViews.push(a),this.container.addChild(a.container)}},h),l(()=>{var t;return(t=this.layer)==null?void 0:t.polygonSymbol},t=>{this._graphicsViewMap.polygon.renderer=new n({symbol:t})},h),l(()=>{var t;return(t=this.layer)==null?void 0:t.lineSymbol},t=>{this._graphicsViewMap.polyline.renderer=new n({symbol:t})},h),l(()=>{var t;return(t=this.layer)==null?void 0:t.pointSymbol},t=>{this._graphicsViewMap.point.renderer=new n({symbol:t})},h)])}detach(){this._clear()}moveEnd(){}viewChange(){for(const t of this.graphicsViews)t.viewChange()}_clear(){this.container.removeAllChildren();for(const t of this.graphicsViews)t.destroy();this._graphicsViewMap={},this._popupTemplates.clear(),this.graphicsViews.length=0}};y=u([V("esri.views.2d.layers.GeoRSSLayerView2D")],y);const Vi=y;export{Vi as default};
