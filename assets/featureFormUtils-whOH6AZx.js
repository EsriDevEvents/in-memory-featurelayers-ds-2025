import{gz as f,O as $,gk as V,gl as _,gA as L,gB as F,b0 as b,gC as A,G as j,gD as g,gE as I,gF as R,gG as D,bX as U}from"./index-Dv-JqQDv.js";import{s as x}from"./substitute-BVUBXY1A.js";const G=e=>(e==null?void 0:e.type)==="field",E=e=>(e==null?void 0:e.type)==="group",Z=e=>(e==null?void 0:e.type)==="relationship",P=e=>e.type==="text",W=e=>!E(e)&&e.group!=null,N=e=>e.reduce((t,n)=>E(n)?[...t,...n.inputs]:[...t,n],[]),q=e=>N(e).filter(G),z=e=>N(e).filter(Z),Y=e=>e!=null&&(m(e,"combo-box")||m(e,"radio-buttons")),m=(e,t)=>{var n;return e!=null&&((n=e.input)==null?void 0:n.type)===t},J=e=>e!=null&&(m(e,"text-box")||m(e,"text-area")),K=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value"),Q=e=>"items"in e;function X(e){const{attributes:t,fieldsIndex:n,label:r,timeZone:i}=e;if(!t||typeof t!="object")return r;const o=Object.keys(t).filter(s=>f(r,s)),u=o.map(s=>t[s]),a=o.map(s=>n.get(s)).filter($);return k(r,S({values:u,fields:a,timeZone:i}))}const d="expression/",w="expr/",C="field/";function ee(e){const[t,n]=e.split(d);return t===""&&n?n:(j.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${d}/expressionName'`),"")}function te(e){return`${d}${e}`}function ne(e){return`${C}${e}`}function re(e){return e.startsWith(d)}function ie(e){return e.startsWith(w)}function S(e){const{fields:t,values:n}=e,r=e.timeZone??void 0,i=t.map((o,u)=>{let a=n[u];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(p=>p.code===a);s!=null&&s.name&&(a=s.name)}return(V(o)||_(o))&&(a=L(o,a,{timeZone:r,...F(o)})),[o.name,a]});return Object.fromEntries(i)}function k(e,t){return b(b(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,r])=>[n.toLowerCase(),r])))}const oe=e=>{var n,r,i,o;const t={typeFieldName:null,types:[]};return e&&(e.type==="subtype-sublayer"?(t.typeFieldName=(n=e.parent)==null?void 0:n.subtypeField,t.types=((r=e.parent)==null?void 0:r.subtypes)??[]):e.type==="subtype-group"||e.type==="feature"&&((i=e.subtypes)!=null&&i.length)?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:u,name:a,domains:s})=>({code:u,name:a,domains:s}))),t.typeFieldName!=null&&(t.typeFieldName=((o=e.getField(t.typeFieldName))==null?void 0:o.name)??t.typeFieldName)),t},ae=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};var c;(function(e){e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"})(c||(c={}));const O={type:"number"},T={type:"number",intlOptions:{notation:"scientific"}};function h(e){return e>=1e7||e<=-1e7}function B(e,{validationErrors:t}){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const se=(e,t,n)=>{const{dataType:r,error:i,minLength:o,value:u,required:a}=e,s=t==null?void 0:t.validationErrors;if(!s||!i)return null;if(a&&u===null)return s.cannotBeNull;if(i===g.VALUE_OUT_OF_RANGE||i===I.OUT_OF_RANGE){const{field:p,range:l}=e,y={type:"date",intlOptions:{timeZone:p.type==="date"&&n?n:void 0,...F(p)}},v=B(l,t);return x(v,l,{format:{max:r==="date"?y:l.max!=null&&h(l.max)?T:O,min:r==="date"?y:l.min!=null&&h(l.min)?T:O}})}return i===g.INVALID_CODED_VALUE?s.invalidCodedValue:i===R.INVALID_TYPE?s.invalidType:i===c.TOO_SHORT?x(s.tooShort,{min:o}):(c.TOO_LONG,null)},ue=e=>{var i;if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,r=(i=e.geometry)==null?void 0:i.type;return r==="polyline"||n==="polyline"?"line":r==="mesh"||n==="mesh"||n==="multipatch"?"cube":r==="multipoint"||n==="multipoint"?"point":r||n||"table"},le=e=>{var n;const t=[];if(e.formTemplate){const{description:r,title:i}=e.formTemplate;(n=e.fields)==null||n.forEach(o=>{const u=i&&f(i,o.name),a=r&&f(r,o.name);(u||a)&&t.push(o.name)})}return t};function pe(e,t){var r;const n=t??("formTemplate"in e&&e.formTemplate);return n?(((r=n.elements)==null?void 0:r.filter(D))??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function me(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function de(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return A(t.objectType),!1}}function ce(e,t,n){var o,u;if(!e||!("subtypes"in e))return!1;const r=(o=e.subtypes)==null?void 0:o.find(a=>a.code===n);if(!r)return!1;const i=(u=e.subtypes)==null?void 0:u.find(a=>a.code===t);return!U(r.defaultValues,i==null?void 0:i.defaultValues)&&Object.values(r.defaultValues).some(a=>a!=null)}export{ne as $,ue as B,oe as C,re as D,K as E,J as F,ae as G,ee as I,me as J,de as K,c as M,z as N,N as O,ce as Q,te as R,S,W as T,X as U,Q as V,le as Y,E as b,Z as g,Y as h,q as j,se as q,m as v,ie as w,P as x,G as y,pe as z};
