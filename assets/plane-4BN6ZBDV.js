import{aI as o,dB as v,dy as x,aL as F,aJ as O,ad as N,dA as T,lH as H,aV as J,W as b,ca as m,dz as q,c3 as W,aN as k,dx as z}from"./index-Dv-JqQDv.js";import{e as D}from"./mat3f64-BBpwCtoL.js";import{e as K}from"./mat4f64-Dk4dwAN8.js";import{e as R}from"./quatf64-BrpT0VRp.js";import{n as S}from"./vec2f64-Diu2Kaa8.js";import{j as U}from"./mathUtils-urfecwwD.js";function Nt(e,t,r){const c=o(e,t)/o(e,e);return T(r,e,c)}function C(e,t){return o(e,t)/v(e)}function ht(e,t){const r=o(e,t)/(v(e)*v(t));return-x(r)}function Mt(e,t,r){F(l,e),F(j,t);const c=o(l,j),n=x(c),s=O(l,l,j);return o(s,r)<0?2*Math.PI-n:n}const l=N(),j=N();class u{constructor(t){this._create=t,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&H(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const t=2*this._itemsPtr;this._items.length>t&&(this._items.length=t),this._itemsPtr=0}static createVec2f64(){return new u(S)}static createVec3f64(){return new u(N)}static createVec4f64(){return new u(J)}static createMat3f64(){return new u(D)}static createMat4f64(){return new u(K)}static createQuatf64(){return new u(R)}get test(){}}const mt=u.createVec2f64(),I=u.createVec3f64(),Y=u.createVec4f64();u.createMat3f64();const $t=u.createMat4f64(),gt=u.createQuatf64();function Q(e=_){return[e[0],e[1],e[2],e[3]]}function _t(e=_[0],t=_[1],r=_[2],c=_[3]){return B(e,t,r,c,Y.get())}function Z(e,t){return B(t[0],t[1],t[2],t[3],e)}function Et(e){return e}function B(e,t,r,c,n=Q()){return n[0]=e,n[1]=t,n[2]=r,n[3]=c,n}function Pt(e,t,r){return k(r,e),r[3]=t,r}function tt(e,t,r){const c=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function et(e,t,r,c=Q()){const n=r[0]-t[0],s=r[1]-t[1],i=r[2]-t[2],a=e[0]-t[0],E=e[1]-t[1],P=e[2]-t[2],$=s*P-i*E,w=i*a-n*P,y=n*E-s*a,L=$*$+w*w+y*y,X=Math.abs(L-1)>1e-5&&L>1e-12?1/Math.sqrt(L):1;return c[0]=$*X,c[1]=w*X,c[2]=y*X,c[3]=-(c[0]*e[0]+c[1]*e[1]+c[2]*e[2]),c}function G(e,t,r,c=0,n=Math.floor(r*(1/3)),s=Math.floor(r*(2/3))){if(r<3)return!1;t(g,c);let i=n,a=!1;for(;i<r-1&&!a;)t(M,i),i++,a=!b(g,M);if(!a)return!1;for(i=Math.max(i,s),a=!1;i<r&&!a;)t(h,i),i++,m(A,g,M),F(A,A),m(d,M,h),F(d,d),a=!b(g,h)&&!b(M,h)&&Math.abs(o(A,d))<rt;return a?(et(g,M,h,e),!0):(c!==0||n!==1||s!==2)&&G(e,t,r,0,1,2)}function lt(e,t,r=!0){const c=t.length/3;return G(e,(n,s)=>z(n,t[3*s+0],t[3*s+1],t[3*s+2]),r?c-1:c)}const rt=.99619469809,g=N(),M=N(),h=N(),A=N(),d=N();function At(e,t,r){return t!==e&&Z(e,t),e[3]=-o(e,r),e}function dt(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Ft(e,t,r,c){return O(h,t,e),tt(r,h,c)}function Tt(e,t,r,c){return p(e,t,m(I.get(),r,t),nt,c)}function Vt(e,t,r){return t!=null&&p(e,t.origin,t.direction,it,r)}function pt(e,t,r){return p(e,t.origin,t.vector,f.NONE,r)}function wt(e,t,r){return p(e,t.origin,t.vector,f.CLAMP,r)}function yt(e,t){return V(e,t)>=0}function Lt(e,t){const r=o(e,t.ray.direction),c=-V(e,t.ray.origin);if(c<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return c>0;if((c<0||r<0)&&!(c<0&&r<0))return!0;const n=c/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function Xt(e,t){const r=o(e,t.ray.direction),c=-V(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return c>0;const n=c/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function bt(e,t,r){const c=T(I.get(),e,-e[3]),n=ct(e,m(I.get(),t,c),I.get());return q(r,n,c),r}function Ct(e,t,r,c){const n=e,s=I.get(),i=I.get();U(n,s,i);const a=m(I.get(),r,t),E=C(s,a),P=C(i,a),$=C(n,a);return z(c,E,P,$)}function ct(e,t,r){const c=T(I.get(),e,o(e,t));return m(r,t,c),r}function jt(e,t){return Math.abs(V(e,t))}function V(e,t){return o(e,t)+e[3]}function p(e,t,r,c,n){const s=o(e,r);if(s===0)return!1;let i=-(o(e,t)+e[3])/s;return c&f.CLAMP&&(i=W(i,0,1)),!(!(c&f.INFINITE_MIN)&&i<0||!(c&f.INFINITE_MAX)&&i>1)&&(q(n,t,T(n,r,i)),!0)}const _=[0,0,1,0];var f;(function(e){e[e.NONE=0]="NONE",e[e.CLAMP=1]="CLAMP",e[e.INFINITE_MIN=4]="INFINITE_MIN",e[e.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const nt=f.INFINITE_MIN|f.INFINITE_MAX,it=f.INFINITE_MAX;export{Z as A,wt as B,yt as D,Q as E,Et as F,Lt as G,Xt as H,bt as J,Ct as K,At as O,ct as Q,jt as R,Vt as S,B as T,Ft as U,V,G as X,Pt as _,C as a,et as b,I as c,ht as d,Nt as e,$t as f,lt as g,tt as j,Mt as m,gt as o,dt as q,Y as r,mt as t,_t as v,Tt as w,pt as z};
